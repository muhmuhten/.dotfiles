#!/usr/bin/execlineb -P
background {
  if -n { tmux list-sessions }
  if { tmux new-session -d }
  if { loopwhilex -x 0 ping -w1 -c1 www.google.com }
  tmux send-keys irssi C-m
}

getpid pid import -iu pid
define dest /tmp/svscan${pid}
if { mkdir $dest }
if { pipeline { tar cC .s6 . } tar xC $dest }

emptyenv -p
s6-svscan $dest
